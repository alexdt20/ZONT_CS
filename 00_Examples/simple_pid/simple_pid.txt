

Пример пид регулятора

Сам регулятор выполнен в виде ф-ции
pid_work

которая запускается с параметрами pid set in
и возвращает значение выхода регулятора.

pid - это список значений для внутренней работы пид регулятора (пока там только накопительная сумма).
set - уставка регулятора, которую он пытается достичь.
in - значение с датчика обратной связи.

коэффициенты задаются в коде самой ф-ции пид регулятора
kp - пропорциональный коэффициент (значение х1000, 10 соответствует 0,01)
ki - интегральный коэффициент (значение х1000, 10 соответствует 0,01))

вызывать регулятор можно по таймеру с периодом зависящим от задачи (в примере 1 сек)

в примере в качестве датчика обратной связи используется термодатчик с именем "датчик тн"
уставка задаётся в переменной скрипта v_set

протестировать алгоритм можно через терминал:
создать аналоговый датчик температуры с неназначенным источником сигнала

тогда значение датчика можно установить командой:
>objcmd "датчик тн" 2930
значение так записывается в десятых долях кельвина. т.е. 2930 соответствует 20.0 градусов.

проверить значение температуры можно командой 
>get_t "датчик тн"

(можно использовать реальный датчик)

значение уставки можно задать так:
set v_set 250
в десятых долях градусов кельвина (250 -> 25.0 гр)


после записи скрипта в память и сброса контроллера, если отправить команду >
то в терминал будет выводиться раз в секунду значение регулятора.

15:25:17 <pid: 49
15:25:18 <pid: 49
15:25:19 <pid: 48
15:25:20 <pid: 48
15:25:21 <pid: 48
15:25:22 <pid: 47
15:25:23 <pid: 47
15:25:24 <pid: 47
15:25:25 <pid: 46
15:25:26 <pid: 46
15:25:27 <pid: 46
15:25:28 <pid: 45
15:25:29 <pid: 45
15:25:30 <pid: 45

Это же значенпие выводится и в аналоговый выход (который должен называться "выход  аналоговый")

